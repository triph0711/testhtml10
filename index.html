<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Speech-to-Text App</title>  <!-- Modified Title Here -->
</head>
<body>
    <h1>Speech to Text with Groq API</h1>
    <button id="start">Start Recording</button>
    <button id="stop" disabled>Stop Recording</button>
    <p id="transcription">Transcription will appear here...</p>

    <script>
        const startButton = document.getElementById('start');
        const stopButton = document.getElementById('stop');
        const transcriptionParagraph = document.getElementById('transcription');

        let mediaRecorder;
        let audioChunks = [];
        let audioBlob;

        // Replace with your Groq API URL and API key
        const API_URL = 'https://api.groq.com/v1/speech-to-text';  // Example endpoint
        const API_KEY = 'your-groq-api-key';  // Replace with your Groq API key

        // Function to start recording
        startButton.addEventListener('click', async () => {
            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
            mediaRecorder = new MediaRecorder(stream);

            mediaRecorder.ondataavailable = (event) => {
                audioChunks.push(event.data);
            };

            mediaRecorder.onstop = async () => {
                audioBlob = new Blob(audioChunks, { type: 'audio/wav' });

                // Display audio as a player
                const audioURL = URL.createObjectURL(audioBlob);
                const audioPlayer = new Audio(audioURL);
                audioPlayer.controls = true;
                document.body.appendChild(audioPlayer);

                // Send audio to Groq API for transcription
                const formData = new FormData();
                formData.append('audio', audioBlob, 'audio.wav');

                try {
                    // Send audio data to Groq API via POST request
                    const response = await fetch(API_URL, {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${API_KEY}`,
                        },
                        body: formData,
                    });

                    if (response.ok) {
                        const data = await response.json();
                        console.log(data);  // Log the response to inspect it
                        const transcription = data.transcription || 'No transcription available.';
                        transcriptionParagraph.innerText = transcription;
                    } else {
                        const errorData = await response.json();
                        transcriptionParagraph.innerText = 'Failed to transcribe audio.';
                        console.error('API Error:', errorData);
                    }
                } catch (error) {
                    transcriptionParagraph.innerText = 'Error sending audio to Groq API.';
                    console.error('Network Error:', error);
                }
            };

            mediaRecorder.start();
            startButton.disabled = true;
            stopButton.disabled = false;
        });

        // Function to stop recording
        stopButton.addEventListener('click', () => {
            mediaRecorder.stop();
            startButton.disabled = false;
            stopButton.disabled = true;
        });
    </script>
</body>
</html>
